<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YEUNG SHI GROUP - Premium Industrial Machinery</title>
    <!-- Favicon link: Assumes favicon.ico is in frontend/public/img/ -->
    <link rel="icon" href="/public/img/favicon.ico" type="image/x-icon">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Google Fonts: Kantumruy Pro for Khmer and Inter for English -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Kantumruy+Pro:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
<style>
    body {
        font-family: 'Inter', 'Kantumruy Pro', sans-serif;
        scroll-behavior: smooth;
    }
    
    .khmer-font {
        font-family: 'Kantumruy Pro', sans-serif;
    }

    .card-hover-effect {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border: 1px solid #f3f4f6;
    }
    
    .card-hover-effect:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        border-color: #ea580c;
    }

    #mobile-menu {
        transition: transform 0.3s ease-in-out;
        transform: translateX(100%);
    }
    
    #mobile-menu.open {
        transform: translateX(0);
    }

    .map-container {
        position: relative;
        width: 100%;
        padding-bottom: 100%;
        height: 0;
        overflow: hidden;
    }

    .map-container iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }

    @media (min-width: 768px) {
        .map-container {
            padding-bottom: 56.25%;
        }
    }

    .product-image {
        aspect-ratio: 1 / 1;
        object-fit: cover;
        width: 100%;
    }
    
    .loading-spinner {
        border: 4px solid #f3f4f6;
        border-top: 4px solid #ea580c;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 20px auto;
    }
    
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .line-clamp-3 {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    /* Professional Background Styles */
    .hero-bg {
        background: linear-gradient(135deg, rgba(30, 41, 59, 0.9) 0%, rgba(15, 23, 42, 0.9) 100%), 
                    url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800"><rect fill="%230f172a" width="1200" height="800"/><g fill="%231e293b" opacity="0.3"><circle cx="200" cy="100" r="40"/><circle cx="800" cy="200" r="60"/><circle cx="400" cy="500" r="50"/><circle cx="1000" cy="400" r="30"/><circle cx="600" cy="700" r="45"/></g></svg>');
        background-size: cover;
        background-position: center;
    }

    .industrial-bg {
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
    }

    .section-bg {
        background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    }

    /* Modal Styles - UPDATED FOR MOBILE RESPONSIVENESS */
    .modal-overlay {
        background-color: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(4px);
    }
    
    .modal-content {
        transform: scale(0.95);
        opacity: 0;
        transition: all 0.3s ease-out;
        max-width: 400px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
    }
    
    .modal-open .modal-content {
        transform: scale(1);
        opacity: 1;
    }

    /* UPDATED: Mobile Modal Styles - More Compact */
    @media (max-width: 768px) {
        .modal-content {
            max-width: 95%;
            max-height: 85vh;
            margin: 10px auto;
        }
        
        .modal-content .p-4 {
            padding: 12px;
        }
        
        .modal-content .p-4.md\:p-5 {
            padding: 12px;
        }
        
        .social-media-icons {
            margin-top: 12px;
            padding-top: 12px;
            gap: 8px;
        }
        
        .social-icon-modal {
            width: 32px;
            height: 32px;
        }
        
        .social-icon-modal i {
            font-size: 0.8rem;
        }
        
        .modal-content .flex.space-x-3 {
            margin-top: 12px;
        }
        
        .modal-content .flex.space-x-3 button {
            padding: 10px 8px;
            font-size: 0.85rem;
        }
        
        #modalTitle {
            font-size: 1rem;
            line-height: 1.2;
        }
        
        #modalPrice {
            font-size: 0.9rem;
            padding: 6px 10px;
        }
        
        #modalDescription {
            font-size: 0.85rem;
            margin-bottom: 12px;
        }
    }

    /* Filter and Search Styles */
    .filter-dropdown {
        transition: all 0.3s ease;
    }
    
    .filter-option:hover {
        background-color: #fed7aa;
    }

    /* Navbar dropdown */
    .nav-dropdown {
        transition: all 0.3s ease;
    }

    /* Mobile dropdown */
    .mobile-dropdown-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease-out;
    }
    
    .mobile-dropdown-content.open {
        max-height: 200px;
    }

    /* Rotate class for dropdown arrows */
    .rotate-180 {
        transform: rotate(180deg);
    }

    /* Product Title */
    .product-title {
        font-size: 1.125rem;
        font-weight: 700;
        line-height: 1.3;
        margin-bottom: 4px;
    }

    @media (min-width: 768px) {
        .product-title {
            font-size: 1.25rem;
        }
    }

    /* UPDATED: Professional Product Card Styles - COMPACT DESIGN */
    .product-card {
        position: relative;
        overflow: hidden;
        border-radius: 12px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        height: fit-content;
        display: flex;
        flex-direction: column;
    }

    .product-card-badge {
        position: absolute;
        top: 8px;
        left: 8px;
        background: linear-gradient(135deg, #ea580c, #dc2626);
        color: white;
        padding: 3px 6px;
        border-radius: 4px;
        font-size: 0.7rem;
        font-weight: 600;
        z-index: 10;
    }

    .product-image-container {
        position: relative;
        overflow: hidden;
        border-radius: 8px 8px 0 0;
        aspect-ratio: 1 / 1;
    }

    .product-image-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.1) 100%);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 1;
    }

    .product-card:hover .product-image-container::before {
        opacity: 1;
    }

    /* Social Media Icons in Modal */
    .social-media-icons {
        display: flex;
        justify-content: center;
        gap: 12px;
        margin-top: 16px;
        padding-top: 16px;
        border-top: 1px solid #e5e7eb;
    }

    .social-icon-modal {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        color: white;
        text-decoration: none;
    }

    .social-icon-modal:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .social-icon-modal.facebook {
        background: #1877f2;
    }

    .social-icon-modal.telegram {
        background: #0088cc;
    }

    .social-icon-modal.whatsapp {
        background: #25d366;
    }

    .social-icon-modal.messenger {
        background: #006aff;
    }

    /* Professional Grid Layout */
    .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 24px;
    }

    /* UPDATED: Product card content container - COMPACT SPACING */
    .product-card-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        min-height: 0;
        gap: 3px; /* Very small gap between elements */
    }

    /* UPDATED: Price and button container - COMPACT SPACING */
    .product-card-actions {
        margin-top: 6px; /* Reduced spacing */
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 4px;
    }

    /* UPDATED: Compact text elements */
    .compact-text {
        line-height: 1.2;
        margin-bottom: 3px;
    }

    .compact-title {
        line-height: 1.3;
        margin-bottom: 4px;
    }

    /* UPDATED: Mobile-specific product card styles - ULTRA COMPACT */
    @media (max-width: 768px) {
        .products-grid {
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 12px;
        }
        
        .product-card {
            height: auto;
            min-height: 0;
        }
        
        .product-image-container {
            aspect-ratio: 1 / 1;
        }
        
        .product-card .p-4 {
            padding: 8px 6px; /* Reduced padding */
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: auto;
        }
        
        /* UPDATED: Compact title on mobile */
        .product-title {
            font-size: 0.9rem;
            line-height: 1.2;
            margin-bottom: 2px;
            -webkit-line-clamp: 2;
            display: -webkit-box;
            -webkit-box-orient: vertical;
            overflow: hidden;
            height: 2.4em;
        }
        
        /* UPDATED: Very compact description - Single line */
        .product-card p.text-gray-600 {
            font-size: 0.7rem;
            line-height: 1.1;
            margin-bottom: 4px;
            -webkit-line-clamp: 1; /* Only one line */
            display: -webkit-box;
            -webkit-box-orient: vertical;
            overflow: hidden;
            height: 1.1em;
            min-height: 1.1em;
            flex: none;
        }
        
        .product-card .text-base {
            font-size: 0.8rem;
        }
        
        .product-card .bg-orange-500 {
            padding: 4px 6px;
            min-width: 32px;
        }
        
        .product-card-badge {
            font-size: 0.65rem;
            padding: 2px 5px;
            top: 6px;
            left: 6px;
        }

        /* UPDATED: Ultra compact action section */
        .product-card-actions {
            margin-top: 2px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 4px;
        }
        
        /* UPDATED: Even tighter product card content */
        .product-card-content {
            gap: 2px;
        }
    }

    /* For very small screens */
    @media (max-width: 360px) {
        .products-grid {
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            gap: 8px;
        }
        
        .product-card .p-4 {
            padding: 6px 4px; /* Even tighter padding */
        }
        
        .product-title {
            font-size: 0.85rem;
            height: 2.3em;
            margin-bottom: 1px;
        }
        
        .product-card p.text-gray-600 {
            font-size: 0.65rem;
            height: 1.1em;
            margin-bottom: 3px;
        }
        
        .product-card .text-base {
            font-size: 0.75rem;
        }
        
        .product-card-content {
            gap: 1px;
        }
    }

    /* Desktop product card content layout */
    @media (min-width: 769px) {
        .product-card .p-4 {
            padding: 16px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .product-card p.text-gray-600 {
            flex: 1;
            margin-bottom: 8px;
            -webkit-line-clamp: 2;
            display: -webkit-box;
            -webkit-box-orient: vertical;
            overflow: hidden;
            height: 2.4em;
        }

        .product-title {
            margin-bottom: 6px;
        }
        
        .product-card-content {
            gap: 4px;
        }
    }

    /* Enhanced Loading State */
    .skeleton-loader {
        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
    }

    @keyframes loading {
        0% {
            background-position: 200% 0;
        }
        100% {
            background-position: -200% 0;
        }
    }

    /* Loading spinner for submit button */
    .loading-spinner-small {
        border: 2px solid #f3f4f6;
        border-top: 2px solid #ffffff;
        border-radius: 50%;
        width: 16px;
        height: 16px;
        animation: spin 1s linear infinite;
    }
</style>
</head>
<body class="bg-gray-50 text-gray-800 flex flex-col min-h-screen">

    <!-- Header -->
    <header class="bg-white shadow-sm py-4 sticky top-0 z-50">
        <div class="container mx-auto px-4 md:px-6 flex items-center justify-between">
            <a href="/" class="flex items-center space-x-3">
                <img src="/public/img/YYG.png" alt="YEUNG SHI GROUP Logo" class="h-12 md:h-14 w-auto object-contain">
            </a>
            
            <!-- Desktop Navigation -->
            <nav class="hidden md:block">
                <ul class="flex space-x-4 lg:space-x-6 items-center">
                    <li><a href="#home" class="text-gray-700 hover:text-orange-600 font-semibold transition duration-300 text-sm lg:text-base">Home</a></li>
                    <li><a href="#about-us" class="text-gray-700 hover:text-orange-600 font-semibold transition duration-300 text-sm lg:text-base">About Us</a></li>
                    
                    <!-- Products Dropdown -->
                    <li class="relative group">
                        <button class="text-gray-700 hover:text-orange-600 font-semibold transition duration-300 text-sm lg:text-base flex items-center">
                            Products <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </button>
                        <div class="absolute top-full left-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 nav-dropdown opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50">
                            <div id="navCategories" class="py-2">
                                <!-- Categories will be loaded here -->
                                <div class="px-4 py-2 text-gray-500 text-sm">Loading...</div>
                            </div>
                        </div>
                    </li>
                    
                    <li><a href="#contact-us" class="text-gray-700 hover:text-orange-600 font-semibold transition duration-300 text-sm lg:text-base">Contact</a></li>
                    <li><a href="/login" class="bg-orange-600 text-white px-3 lg:px-4 py-2 rounded-lg hover:bg-orange-700 transition duration-300 shadow-sm font-medium text-sm lg:text-base">Login</a></li>
                </ul>
            </nav>

            <!-- Hamburger Icon for Mobile -->
            <button id="hamburger-menu-button" class="md:hidden text-gray-700 hover:text-orange-600 focus:outline-none text-xl">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- Mobile Menu (Off-canvas) -->
    <div id="mobile-menu" class="fixed top-0 right-0 h-full w-64 bg-white shadow-xl z-50 p-6 flex flex-col items-center pt-20 hidden">
        <button id="close-mobile-menu-button" class="absolute top-4 right-4 text-gray-700 hover:text-orange-600 focus:outline-none text-xl">
            <i class="fas fa-times"></i>
        </button>
        <nav class="flex flex-col space-y-4 w-full">
            <a href="#home" class="text-gray-700 hover:text-orange-600 font-semibold transition duration-300 text-lg text-center" data-close-menu>Home</a>
            <a href="#about-us" class="text-gray-700 hover:text-orange-600 font-semibold transition duration-300 text-lg text-center" data-close-menu>About Us</a>
            
            <!-- Mobile Products Dropdown -->
            <div class="border-t border-gray-200 pt-4">
                <button id="mobile-products-toggle" class="text-gray-700 hover:text-orange-600 font-semibold transition duration-300 text-lg w-full text-center flex items-center justify-center">
                    Products <i class="fas fa-chevron-down ml-2 text-sm transition-transform duration-300" id="mobile-products-arrow"></i>
                </button>
                <div id="mobileNavCategories" class="mobile-dropdown-content pl-4 mt-2">
                    <!-- Mobile categories will be loaded here -->
                    <div class="text-gray-500 text-sm text-center">Loading...</div>
                </div>
            </div>
            
            <a href="#contact-us" class="text-gray-700 hover:text-orange-600 font-semibold transition duration-300 text-lg text-center" data-close-menu>Contact</a>
            <a href="/login" class="bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition duration-300 shadow-sm text-center text-lg w-full font-medium mt-4">Login</a>
        </nav>
    </div>

    <main class="flex-grow">
        <!-- Hero Section -->
        <section id="home" class="hero-bg text-white py-16 md:py-24 px-4 md:px-6 text-center">
            <div class="container mx-auto">
                <h1 class="text-4xl md:text-6xl lg:text-7xl font-extrabold mb-6 leading-tight khmer-font">
                    យើងជាដៃគូអាជីវកម្មរបស់អ្នក
                </h1>
                <p class="text-xl md:text-2xl lg:text-3xl font-light mb-8 md:mb-12 max-w-4xl mx-auto">
                    YEUNG SHI GROUP: Premium Industrial Machinery & Equipment Solutions
                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <a href="#our-products" class="bg-orange-600 text-white font-bold py-3 md:py-4 px-8 md:px-12 rounded-lg text-lg md:text-xl shadow-lg hover:bg-orange-700 transform hover:scale-105 transition duration-300 inline-flex items-center justify-center">
                        Explore Machinery <i class="fas fa-arrow-right ml-3"></i>
                    </a>
                    <a href="#contact-us" class="bg-transparent border-2 border-white text-white font-bold py-3 md:py-4 px-8 md:px-12 rounded-lg text-lg md:text-xl hover:bg-white hover:text-gray-900 transform hover:scale-105 transition duration-300 inline-flex items-center justify-center">
                        Get Quote <i class="fas fa-comment-dots ml-3"></i>
                    </a>
                </div>
            </div>
        </section>

        <!-- Stats Section -->
        <section class="py-12 md:py-16 bg-white">
            <div class="container mx-auto px-4 md:px-6">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 md:gap-8">
                    <div class="text-center">
                        <div class="text-3xl md:text-5xl font-black text-orange-600 mb-2">19+</div>
                        <div class="text-gray-600 font-semibold">Years Experience</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl md:text-5xl font-black text-orange-600 mb-2">5000+</div>
                        <div class="text-gray-600 font-semibold">Machines Sold</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl md:text-5xl font-black text-orange-600 mb-2">200+</div>
                        <div class="text-gray-600 font-semibold">Product Types</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl md:text-5xl font-black text-orange-600 mb-2">24/7</div>
                        <div class="text-gray-600 font-semibold">Support</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Us Section -->
        <section id="about-us" class="py-12 md:py-16 px-4 md:px-6 section-bg">
            <div class="container mx-auto">
                <div class="bg-white p-6 md:p-8 rounded-lg shadow-sm border border-gray-200">
                    <h2 class="text-2xl md:text-4xl font-bold text-orange-700 mb-4 md:mb-6 text-center khmer-font">អំពី YEUNG SHI GROUP</h2>
                    <p class="text-sm md:text-lg text-gray-700 leading-relaxed text-center max-w-4xl mx-auto mb-8">
                        Established in Guangzhou, China, in the 1990s, YEUNG SHI GROUP proudly commenced its operations in Cambodia in 2005. 
                        Our unwavering commitment is to meticulously identify and passionately serve the dynamic target market in Cambodia, 
                        delivering unparalleled quality products and exceptional services that foster growth and innovation.
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 mt-8">
                        <div class="text-center p-4 md:p-6 bg-orange-50 rounded-lg">
                            <i class="fas fa-cogs text-3xl md:text-4xl text-orange-600 mb-3 md:mb-4"></i>
                            <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-2 md:mb-3">Industrial Machinery</h3>
                            <p class="text-gray-600 text-sm md:text-base">State-of-the-art equipment for manufacturing and production with latest technology</p>
                        </div>
                        <div class="text-center p-4 md:p-6 bg-orange-50 rounded-lg">
                            <i class="fas fa-tools text-3xl md:text-4xl text-orange-600 mb-3 md:mb-4"></i>
                            <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-2 md:mb-3">Technical Support</h3>
                            <p class="text-gray-600 text-sm md:text-base">Comprehensive after-sales service, maintenance, and technical training</p>
                        </div>
                        <div class="text-center p-4 md:p-6 bg-orange-50 rounded-lg">
                            <i class="fas fa-shipping-fast text-3xl md:text-4xl text-orange-600 mb-3 md:mb-4"></i>
                            <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-2 md:mb-3">Fast Delivery</h3>
                            <p class="text-gray-600 text-sm md:text-base">Efficient logistics and nationwide distribution with installation support</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Our Products & Services Section -->
        <section id="our-products" class="py-12 md:py-16 px-4 md:px-6 bg-gradient-to-br from-gray-50 to-orange-50">
            <div class="container mx-auto">
                <div class="text-center mb-12">
                    <h2 class="text-2xl md:text-4xl font-bold text-orange-700 mb-4 khmer-font">ផលិតផលរបស់យើង</h2>
                    <p class="text-gray-600 max-w-2xl mx-auto text-sm md:text-base">Discover our premium range of industrial machinery and equipment solutions</p>
                </div>

                <!-- Search and Filter Section -->
                <div class="mb-8 md:mb-12 bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <div class="flex flex-col md:flex-row gap-4 items-center justify-between">
                        <!-- Search Bar -->
                        <div class="flex-1 w-full md:w-auto">
                            <div class="relative">
                                <input type="text" id="searchInput" placeholder="Search products..." 
                                    class="w-full p-3 pl-10 pr-10 rounded-lg border border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition duration-200 text-sm font-medium">
                                <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm"></i>
                                <button id="clearSearchButton" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition duration-200 hidden">
                                    <i class="fas fa-times text-sm"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Category Filter -->
                        <div class="w-full md:w-56 relative">
                            <button id="categoryFilterButton" class="w-full p-3 rounded-lg border border-gray-300 bg-white text-gray-700 text-sm flex items-center justify-between hover:border-orange-500 transition duration-200 font-bold">
                                <span>All Categories</span>
                                <i class="fas fa-chevron-down text-gray-400 text-xs"></i>
                            </button>
                            <div id="categoryDropdown" class="absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-10 hidden max-h-60 overflow-y-auto">
                                <div class="p-2">
                                    <div class="filter-option p-2 rounded cursor-pointer hover:bg-orange-50 transition duration-200 text-sm font-bold" data-category="all">
                                        All Categories
                                    </div>
                                    <!-- Categories will be loaded here dynamically -->
                                </div>
                            </div>
                        </div>

                        <!-- Results Count -->
                        <div class="text-sm text-gray-600 whitespace-nowrap font-bold bg-orange-50 px-4 py-2 rounded-lg">
                            <span id="resultsCount">0</span> products found
                        </div>
                    </div>
                </div>

                <!-- Loading State -->
                <div id="productsLoading" class="text-center py-12">
                    <div class="loading-spinner"></div>
                    <p class="text-gray-600 mt-4 text-sm md:text-base font-medium">Loading premium products...</p>
                </div>

                <!-- Products Grid - Professional Layout -->
                <div id="productsGrid" class="products-grid hidden">
                    <!-- Products will be loaded here dynamically -->
                </div>

                <!-- No Products State -->
                <div id="noProducts" class="text-center py-16 hidden">
                    <div class="bg-white p-8 rounded-xl shadow-sm border border-gray-200 max-w-md mx-auto">
                        <i class="fas fa-search text-5xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">No Products Found</h3>
                        <p class="text-gray-500 text-sm mb-4">Try adjusting your search or filter criteria</p>
                        <button onclick="resetFilters()" class="bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700 transition duration-300 font-medium">
                            Reset Filters
                        </button>
                    </div>
                </div>

                <!-- Legacy Categories (Hidden by default, shows if no dynamic products) -->
                <div id="legacyCategories" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 hidden">
                    <!-- Machine Category Card -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 card-hover-effect">
                        <div class="text-orange-600 text-4xl mb-4 text-center">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <h3 class="text-xl font-bold text-orange-800 mb-4 text-center khmer-font">ម៉ាស៊ីន</h3>
                        <ul class="list-disc list-inside text-gray-700 space-y-2 text-sm">
                            <li>MDF Bending R6A</li>
                            <li>Automatic Gear-Puncture Machines</li>
                            <li>Wood Carving Machines</li>
                            <li>Steel Cutting Machines</li>
                            <li>UV Printing Machines</li>
                            <li>Water Filter Systems</li>
                            <li>Kitchen Appliances</li>
                        </ul>
                    </div>
                    <!-- Flavours Category Card -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 card-hover-effect">
                        <div class="text-orange-600 text-4xl mb-4 text-center">
                            <i class="fas fa-blender-phone"></i>
                        </div>
                        <h3 class="text-xl font-bold text-orange-800 mb-4 text-center khmer-font">រសជាតិ</h3>
                        <ul class="list-disc list-inside text-gray-700 space-y-2 text-sm">
                            <li>Shaker</li>
                            <li>Choroney Jelly</li>
                            <li>Fruit-Flavored Mix Powders</li>
                            <li>Milk Powder</li>
                            <li>Natural Cacao Powder</li>
                            <li>Citric Acid</li>
                            <li>Various Flavorings</li>
                        </ul>
                    </div>
                    <!-- Trade Category Card -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 card-hover-effect">
                        <div class="text-orange-600 text-4xl mb-4 text-center">
                            <i class="fas fa-boxes"></i>
                        </div>
                        <h3 class="text-xl font-bold text-orange-800 mb-4 text-center khmer-font">ពាណិជ្ជកម្ម</h3>
                        <ul class="list-disc list-inside text-gray-700 space-y-2 text-sm">
                            <li>Glass Bottles</li>
                            <li>Peanuts</li>
                            <li>Green Beans</li>
                            <li>Desiccants</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contact Us Section -->
        <section id="contact-us" class="py-12 md:py-16 px-4 md:px-6 contact-bg relative">
            <div class="container mx-auto relative z-10">
                <div class="text-center mb-10 md:mb-16">
                    <h2 class="text-2xl md:text-4xl font-bold text-orange-700 mb-3 md:mb-4 khmer-font">ទំនាក់ទំនងពួកយើង</h2>
                    <p class="text-gray-600 max-w-2xl mx-auto text-sm md:text-base">Get in touch with our team for premium industrial machinery solutions and expert consultation</p>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12">
                    <!-- Contact Information -->
                    <div>
                        <h3 class="text-xl md:text-2xl font-bold text-gray-800 mb-6 md:mb-8 khmer-font">ទំនាក់ទំនងផ្ទាល់</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-8 md:mb-10">
                            <!-- Contact Information Cards -->
                            <div class="contact-card bg-white p-4 md:p-5 rounded-lg shadow-sm border border-gray-200 flex items-start">
                                <div class="bg-orange-100 p-3 rounded-lg mr-4">
                                    <i class="fas fa-map-marker-alt text-orange-600 text-lg"></i>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800 mb-1 khmer-font">ទីតាំង</h4>
                                    <p class="text-gray-700 text-sm">Building 230, 271 Yothapol Khemarak Phoumin Boulevard, Phnom Penh</p>
                                </div>
                            </div>
                            
                            <div class="contact-card bg-white p-4 md:p-5 rounded-lg shadow-sm border border-gray-200 flex items-start">
                                <div class="bg-orange-100 p-3 rounded-lg mr-4">
                                    <i class="fas fa-phone-alt text-orange-600 text-lg"></i>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800 mb-1 khmer-font">ទូរស័ព្ទ</h4>
                                    <p class="text-gray-700 text-sm">010 / 011 / 012 / 070 : 309 302</p>
                                </div>
                            </div>
                            
                            <div class="contact-card bg-white p-4 md:p-5 rounded-lg shadow-sm border border-gray-200 flex items-start">
                                <div class="bg-orange-100 p-3 rounded-lg mr-4">
                                    <i class="fas fa-envelope text-orange-600 text-lg"></i>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800 mb-1 khmer-font">អ៊ីមែល</h4>
                                    <a href="mailto:yeungshigroup123@gmail.com" class="text-orange-600 hover:underline text-sm">yeungshigroup123@gmail.com</a>
                                </div>
                            </div>
                            
                            <div class="contact-card bg-white p-4 md:p-5 rounded-lg shadow-sm border border-gray-200 flex items-start">
                                <div class="bg-orange-100 p-3 rounded-lg mr-4">
                                    <i class="fas fa-clock text-orange-600 text-lg"></i>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800 mb-1 khmer-font">ម៉ោងធ្វើការ</h4>
                                    <p class="text-gray-700 text-sm">Mon - Sat: 8:00 am - 5:30 pm</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Map Location Section -->
                        <div class="mb-6 md:mb-8">
                            <h3 class="text-xl md:text-2xl font-bold text-gray-800 mb-4 md:mb-6 khmer-font">ស្វែងរកពួកយើងនៅលើផែនទី</h3>
                            <div class="map-container w-full rounded-lg overflow-hidden shadow-sm border border-gray-200">
                                <iframe
                                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d4418.8774338907315!2d104.9118852179681!3d11.534321742389025!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x310950e6f508d97f%3A0x3fe425c8d8a84794!2sYeung%20Shi%20Group%20(YSG)!5e1!3m2!1sen!2skh!4v1755503497818!5m2!1sen!2skh" 
                                    style="border:0;" 
                                    allowfullscreen="" 
                                    loading="lazy" 
                                    referrerpolicy="no-referrer-when-downgrade">
                                </iframe>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Contact Form -->
                    <div>
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-sm border border-gray-200">
                            <h3 class="text-xl md:text-2xl font-bold text-orange-700 mb-4 md:mb-6 khmer-font">ផ្ញើសារមកពួកយើង</h3>
                            
                            <div id="formSuccess" class="form-success bg-green-50 border border-green-200 text-green-700 p-4 rounded-lg mb-6 text-center hidden">
                                <i class="fas fa-check-circle text-green-500 text-xl mb-2"></i>
                                <p class="font-medium">Thank you for your message! We'll get back to you soon.</p>
                            </div>
                            
                            <form id="contactForm" class="space-y-4 md:space-y-5">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label for="firstName" class="block text-gray-700 text-sm font-medium mb-1">First Name</label>
                                        <input type="text" id="firstName" name="firstName" required
                                               class="contact-form-input w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition duration-200 text-sm">
                                        <div class="text-red-500 text-xs mt-1 hidden" id="firstNameError">Please enter your first name</div>
                                    </div>
                                    <div>
                                        <label for="lastName" class="block text-gray-700 text-sm font-medium mb-1">Last Name</label>
                                        <input type="text" id="lastName" name="lastName" required
                                               class="contact-form-input w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition duration-200 text-sm">
                                        <div class="text-red-500 text-xs mt-1 hidden" id="lastNameError">Please enter your last name</div>
                                    </div>
                                </div>
                                
                                <div>
                                    <label for="email" class="block text-gray-700 text-sm font-medium mb-1">Email Address</label>
                                    <input type="email" id="email" name="email" required
                                           class="contact-form-input w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition duration-200 text-sm">
                                    <div class="text-red-500 text-xs mt-1 hidden" id="emailError">Please enter a valid email address</div>
                                </div>
                                
                                <div>
                                    <label for="phone" class="block text-gray-700 text-sm font-medium mb-1">Phone Number</label>
                                    <input type="tel" id="phone" name="phone"
                                           class="contact-form-input w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition duration-200 text-sm">
                                </div>
                                
                                <div>
                                    <label for="company" class="block text-gray-700 text-sm font-medium mb-1">Company (Optional)</label>
                                    <input type="text" id="company" name="company"
                                           class="contact-form-input w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition duration-200 text-sm">
                                </div>
                                
                                <div>
                                    <label for="subject" class="block text-gray-700 text-sm font-medium mb-1">Subject</label>
                                    <select id="subject" name="subject" required
                                            class="contact-form-input w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition duration-200 text-sm">
                                        <option value="" disabled selected>Select an option</option>
                                        <option value="general">General Inquiry</option>
                                        <option value="product">Product Information</option>
                                        <option value="quote">Request a Quote</option>
                                        <option value="support">Technical Support</option>
                                        <option value="other">Other</option>
                                    </select>
                                    <div class="text-red-500 text-xs mt-1 hidden" id="subjectError">Please select a subject</div>
                                </div>
                                
                                <div>
                                    <label for="message" class="block text-gray-800 text-sm font-medium mb-1">Message</label>
                                    <textarea id="message" name="message" rows="4" required
                                              class="contact-form-input w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition duration-200 text-sm"></textarea>
                                    <div class="text-red-500 text-xs mt-1 hidden" id="messageError">Please enter your message</div>
                                </div>
                                
                                <button type="submit" id="submitButton" 
                                        class="w-full bg-orange-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-orange-700 transition duration-300 shadow-sm flex items-center justify-center">
                                    <span id="submitText">Send Message</span>
                                    <div id="submitSpinner" class="ml-2 hidden">
                                        <div class="loading-spinner-small"></div>
                                    </div>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

   <!-- Footer -->
<footer class="bg-gray-900 text-white pt-12 pb-6">
    <div class="container mx-auto px-4 md:px-6">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-8">
            <!-- Contact Information -->
            <div>
                <h3 class="text-xl font-bold mb-4 text-orange-500">YEUNG SHI GROUP</h3>
                <div class="space-y-3">
                    <div class="flex items-start">
                        <i class="fas fa-map-marker-alt text-orange-500 mt-1 mr-3"></i>
                        <p class="text-gray-300">Phnom Penh, Cambodia</p>
                    </div>
                    <div class="flex items-start">
                        <i class="fas fa-phone-alt text-orange-500 mt-1 mr-3"></i>
                        <p class="text-gray-300">010 / 011 / 012 / 070 : 309 302</p>
                    </div>
                    <div class="flex items-start">
                        <i class="fas fa-envelope text-orange-500 mt-1 mr-3"></i>
                        <a href="mailto:yeungshigroup123@gmail.com" class="text-gray-300 hover:text-orange-500 transition duration-300">
                            yeungshigroup123@gmail.com
                        </a>
                    </div>
                </div>
            </div>

            <!-- About Company -->
            <div>
                <h3 class="text-xl font-bold mb-4 text-orange-500">About the Company</h3>
                <p class="text-gray-300 leading-relaxed">
                    Established in Guangzhou, China, in the 1990s, YEUNG SHI GROUP proudly commenced 
                    its operations in Cambodia in 2005. We deliver unparalleled quality products and 
                    exceptional services that foster growth and innovation.
                </p>
            </div>

            <!-- Products -->
            <div>
                <h3 class="text-xl font-bold mb-4 text-orange-500">Our Products</h3>
                <ul class="space-y-2">
                    <li><a href="#our-products" class="text-gray-300 hover:text-orange-500 transition duration-300">Industrial Machinery</a></li>
                    <li><a href="#our-products" class="text-gray-300 hover:text-orange-500 transition duration-300">Flavours & Ingredients</a></li>
                    <li><a href="#our-products" class="text-gray-300 hover:text-orange-500 transition duration-300">Trade Products</a></li>
                    <li><a href="#our-products" class="text-gray-300 hover:text-orange-500 transition duration-300">Technical Support</a></li>
                </ul>
            </div>

            <!-- Quick Links -->
            <div>
                <h3 class="text-xl font-bold mb-4 text-orange-500">Quick Links</h3>
                <ul class="space-y-2">
                    <li><a href="#home" class="text-gray-300 hover:text-orange-500 transition duration-300">Home</a></li>
                    <li><a href="#about-us" class="text-gray-300 hover:text-orange-500 transition duration-300">About Us</a></li>
                    <li><a href="#our-products" class="text-gray-300 hover:text-orange-500 transition duration-300">Products</a></li>
                    <li><a href="#contact-us" class="text-gray-300 hover:text-orange-500 transition duration-300">Contact</a></li>
                    <li><a href="/login" class="text-gray-300 hover:text-orange-500 transition duration-300">Login</a></li>
                </ul>
            </div>
        </div>

        <!-- Social Media & Copyright -->
        <div class="border-t border-gray-700 pt-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <p class="text-gray-400 text-sm">
                        &copy; 2025 Yeung Shi Group. All rights reserved.
                    </p>
                </div>
                                <div class="flex space-x-3">
                        <a href="#" class="bg-gray-800 text-white w-10 h-10 rounded-full hover:bg-orange-600 transition duration-300 flex items-center justify-center">
                            <i class="fab fa-facebook-f text-sm"></i>
                        </a>
                        <a href="#" class="bg-gray-800 text-white w-10 h-10 rounded-full hover:bg-orange-600 transition duration-300 flex items-center justify-center">
                            <i class="fab fa-telegram text-sm"></i>
                        </a>
                        <a href="#" class="bg-gray-800 text-white w-10 h-10 rounded-full hover:bg-orange-600 transition duration-300 flex items-center justify-center">
                            <i class="fab fa-linkedin-in text-sm"></i>
                        </a>
                        <a href="#" class="bg-gray-800 text-white w-10 h-10 rounded-full hover:bg-orange-600 transition duration-300 flex items-center justify-center">
                            <i class="fab fa-youtube text-sm"></i>
                        </a>
                                </div>
            </div>
        </div>
    </div>
</footer>

    <!-- Product Modal - UPDATED WITH SOCIAL MEDIA ICONS -->
    <div id="productModal" class="fixed inset-0 z-50 hidden">
        <div class="modal-overlay absolute inset-0" id="modalOverlay"></div>
        <div class="flex items-center justify-center min-h-screen p-2 md:p-4">
            <div class="modal-content bg-white rounded-xl shadow-2xl w-full max-h-[90vh] overflow-hidden flex flex-col">
                <div class="relative">
                    <button id="closeModalButton" class="absolute top-2 right-2 z-10 bg-white rounded-full p-1 md:p-2 shadow-lg hover:bg-gray-100 transition duration-200">
                        <i class="fas fa-times text-gray-600 text-sm md:text-base"></i>
                    </button>
                    <!-- Square image container -->
                    <div class="w-full aspect-square">
                        <img id="modalImage" src="" alt="" class="w-full h-full object-cover">
                    </div>
                </div>
                <div class="p-4 md:p-5 flex-grow flex flex-col">
                    <div class="flex justify-between items-start mb-3">
                       <h3 id="modalTitle" class="text-lg md:text-xl font-bold text-gray-800 khmer-font line-clamp-2 flex-1 mr-2"></h3>
                       <span id="modalPrice" class="text-base md:text-lg font-bold text-orange-600 bg-orange-50 px-3 py-1 rounded-lg whitespace-nowrap"></span>
                    </div>
                    <div class="mb-3">
                        <span id="modalCategory" class="inline-block bg-gray-100 text-gray-700 text-xs px-3 py-1 rounded-full font-medium"></span>
                        <span id="modalStatus" class="inline-block ml-2 text-xs px-3 py-1 rounded-full font-medium"></span>
                    </div>
                    <p id="modalDescription" class="text-gray-600 mb-4 text-sm line-clamp-3 flex-grow"></p>
                    
                    <!-- Social Media Icons -->
                  <div class="social-media-icons">
    <a href="#" class="social-icon-modal facebook" title="Share on Facebook">
        <i class="fab fa-facebook-f"></i>
    </a>
    <a href="#" class="social-icon-modal tiktok" title="Follow on TikTok">
        <i class="fab fa-tiktok"></i>
    </a>
    <a href="#" class="social-icon-modal telegram" title="Message on Telegram">
        <i class="fab fa-telegram"></i>
    </a>
</div>
                    
                    <div class="flex space-x-3 mt-4">
                        <button id="closeModalButton2" class="flex-1 bg-gray-500 text-white py-3 rounded-lg hover:bg-gray-600 transition duration-200 font-medium text-sm">
                            Close
                        </button>
                        <button id="contactProductButton" class="flex-1 bg-orange-600 text-white py-3 rounded-lg hover:bg-orange-700 transition duration-200 font-medium text-sm">
                            Contact Us
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
          // Mobile Menu Toggle
    const hamburgerButton = document.getElementById('hamburger-menu-button');
    const closeMobileMenuButton = document.getElementById('close-mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const mobileMenuLinks = mobileMenu.querySelectorAll('a[data-close-menu]');

    function toggleMobileMenu() {
        mobileMenu.classList.toggle('hidden');
        mobileMenu.classList.toggle('open');
        if (mobileMenu.classList.contains('open')) {
            document.body.style.overflow = 'hidden';
        } else {
            document.body.style.overflow = '';
        }
    }

    if (hamburgerButton) {
        hamburgerButton.addEventListener('click', toggleMobileMenu);
    }
    if (closeMobileMenuButton) {
        closeMobileMenuButton.addEventListener('click', toggleMobileMenu);
    }

    mobileMenuLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            if (link.hash) {
                toggleMobileMenu();
            }
        });
    });

    window.addEventListener('resize', () => {
        if (window.innerWidth >= 768) {
            mobileMenu.classList.add('hidden');
            mobileMenu.classList.remove('open');
            document.body.style.overflow = '';
        }
    });

    // Mobile Products Dropdown Toggle
    const mobileProductsToggle = document.getElementById('mobile-products-toggle');
    const mobileProductsArrow = document.getElementById('mobile-products-arrow');
    const mobileNavCategories = document.getElementById('mobileNavCategories');

    if (mobileProductsToggle && mobileNavCategories) {
        mobileProductsToggle.addEventListener('click', () => {
            mobileNavCategories.classList.toggle('open');
            if (mobileProductsArrow) {
                mobileProductsArrow.classList.toggle('rotate-180');
            }
        });
    }

    // Global variables for products and categories
    let allProducts = [];
    let allCategories = [];
    let currentFilter = 'all';
    let currentSearch = '';

    // Helper function to check if we're on mobile
    function isMobileDevice() {
        return window.innerWidth <= 768;
    }

    // Product Modal Functions - UPDATED PRICE DISPLAY
    function openProductModal(product) {
        const modal = document.getElementById('productModal');
        const modalImage = document.getElementById('modalImage');
        const modalTitle = document.getElementById('modalTitle');
        const modalPrice = document.getElementById('modalPrice');
        const modalCategory = document.getElementById('modalCategory');
        const modalStatus = document.getElementById('modalStatus');
        const modalDescription = document.getElementById('modalDescription');

        if (!modal || !modalImage || !modalTitle || !modalPrice) return;

        const imageUrl = product.image || product.imageUrl || '/public/img/placeholder-product.jpg';
        // Display price exactly as stored in the database
        const price = product.price || 'Contact for price';
        
        modalImage.src = imageUrl;
        modalImage.alt = product.title;
        modalTitle.textContent = product.title;
        modalPrice.textContent = price;
        if (modalCategory) modalCategory.textContent = product.category?.name || 'Uncategorized';
        if (modalStatus) {
            modalStatus.textContent = product.isAvailable ? 'In Stock' : 'Out of Stock';
            modalStatus.className = `inline-block ml-2 text-xs px-3 py-1 rounded-full font-medium ${product.isAvailable ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`;
        }
        if (modalDescription) modalDescription.textContent = product.description || 'No description available';

        // Update social media links with product information
        updateSocialMediaLinks(product);

        modal.classList.remove('hidden');
        modal.classList.add('modal-open');
        document.body.style.overflow = 'hidden';
    }

    // Function to update social media share links
    function updateSocialMediaLinks(product) {
        const productTitle = encodeURIComponent(product.title);
        const productDescription = encodeURIComponent(product.description || 'Check out this product from YEUNG SHI GROUP');
        const productImage = encodeURIComponent(product.image || product.imageUrl || '');
        const currentUrl = encodeURIComponent(window.location.href);

        // Facebook share link
        const facebookLink = document.querySelector('.social-icon-modal.facebook');
        if (facebookLink) {
            facebookLink.href = `https://www.facebook.com/sharer/sharer.php?u=${currentUrl}&quote=${productTitle}`;
        }

        // Telegram share link
        const telegramLink = document.querySelector('.social-icon-modal.telegram');
        if (telegramLink) {
            telegramLink.href = `https://t.me/share/url?url=${currentUrl}&text=${productTitle}`;
        }

        // WhatsApp share link
        const whatsappLink = document.querySelector('.social-icon-modal.whatsapp');
        if (whatsappLink) {
            whatsappLink.href = `https://wa.me/?text=${productTitle}%20${currentUrl}`;
        }

        // Messenger share link
        const messengerLink = document.querySelector('.social-icon-modal.messenger');
        if (messengerLink) {
            messengerLink.href = `fb-messenger://share?link=${currentUrl}`;
        }
    }

    function closeProductModal() {
        const modal = document.getElementById('productModal');
        if (modal) {
            modal.classList.add('hidden');
            modal.classList.remove('modal-open');
            document.body.style.overflow = '';
        }
    }

    function contactAboutProduct() {
        const modalTitle = document.getElementById('modalTitle');
        if (!modalTitle) return;
        
        const productName = modalTitle.textContent;
        window.location.href = `#contact-us`;
        closeProductModal();
        
        // Optional: Auto-fill the contact form
        setTimeout(() => {
            const messageTextarea = document.querySelector('textarea');
            if (messageTextarea) {
                messageTextarea.value = `I'm interested in: ${productName}\n\n`;
                messageTextarea.focus();
            }
        }, 500);
    }

    // Modal event listeners (fixed CSP issue)
    const modalOverlay = document.getElementById('modalOverlay');
    const closeModalButton = document.getElementById('closeModalButton');
    const closeModalButton2 = document.getElementById('closeModalButton2');
    const contactProductButton = document.getElementById('contactProductButton');

    if (modalOverlay) modalOverlay.addEventListener('click', closeProductModal);
    if (closeModalButton) closeModalButton.addEventListener('click', closeProductModal);
    if (closeModalButton2) closeModalButton2.addEventListener('click', closeProductModal);
    if (contactProductButton) contactProductButton.addEventListener('click', contactAboutProduct);

    // Close modal with Escape key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            closeProductModal();
        }
    });

    // Navbar Categories Functions
    function loadNavbarCategories(categories) {
        const navCategories = document.getElementById('navCategories');
        const mobileNavCategories = document.getElementById('mobileNavCategories');
        
        if (!navCategories || !mobileNavCategories) return;

        // Clear existing
        navCategories.innerHTML = '';
        mobileNavCategories.innerHTML = '';

        if (categories.length === 0) {
            navCategories.innerHTML = '<div class="px-4 py-2 text-gray-500 text-sm">No categories</div>';
            mobileNavCategories.innerHTML = '<div class="text-gray-500 text-sm text-center">No categories</div>';
            return;
        }

        // Desktop navbar categories
        categories.forEach(category => {
            const categoryLink = document.createElement('a');
            categoryLink.href = '#our-products';
            categoryLink.className = 'block px-4 py-2 text-gray-700 hover:bg-orange-50 hover:text-orange-600 transition duration-200 text-sm';
            categoryLink.textContent = category.name;
            
            categoryLink.addEventListener('click', (e) => {
                e.preventDefault();
                currentFilter = category._id;
                const categoryButton = document.getElementById('categoryFilterButton');
                if (categoryButton) {
                    categoryButton.querySelector('span').textContent = category.name;
                }
                filterProducts();
                // Scroll to products section
                const productsSection = document.getElementById('our-products');
                if (productsSection) {
                    productsSection.scrollIntoView({ behavior: 'smooth' });
                }
            });

            navCategories.appendChild(categoryLink);
        });

        // Mobile navbar categories
        categories.forEach(category => {
            const categoryLink = document.createElement('a');
            categoryLink.href = '#our-products';
            categoryLink.className = 'block text-gray-700 hover:text-orange-600 transition duration-200 text-base py-2 text-center';
            categoryLink.textContent = category.name;
            
            categoryLink.addEventListener('click', (e) => {
                e.preventDefault();
                currentFilter = category._id;
                const categoryButton = document.getElementById('categoryFilterButton');
                if (categoryButton) {
                    categoryButton.querySelector('span').textContent = category.name;
                }
                filterProducts();
                // Close mobile menu and dropdown
                if (mobileNavCategories) mobileNavCategories.classList.remove('open');
                if (mobileProductsArrow) mobileProductsArrow.classList.remove('rotate-180');
                toggleMobileMenu();
            });

            mobileNavCategories.appendChild(categoryLink);
        });
    }

    // Category Filter Functions
    function setupCategoryFilter() {
        const categoryButton = document.getElementById('categoryFilterButton');
        const categoryDropdown = document.getElementById('categoryDropdown');

        if (!categoryButton || !categoryDropdown) return;

        categoryButton.addEventListener('click', () => {
            categoryDropdown.classList.toggle('hidden');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!categoryButton.contains(e.target) && !categoryDropdown.contains(e.target)) {
                categoryDropdown.classList.add('hidden');
            }
        });
    }

    function loadCategoriesIntoFilter(categories) {
        const categoryDropdown = document.getElementById('categoryDropdown');
        
        // Check if category dropdown exists - if not, just load navbar categories and return
        if (!categoryDropdown) {
            console.log('Category dropdown not found, loading only navbar categories');
            loadNavbarCategories(categories);
            return;
        }

        const categoryContainer = categoryDropdown.querySelector('.p-2');
        if (!categoryContainer) {
            console.log('Category container not found, loading only navbar categories');
            loadNavbarCategories(categories);
            return;
        }
        
        // Clear existing content but recreate the "All Categories" option
        categoryContainer.innerHTML = '';
        
        // Recreate "All Categories" option
        const allCategoriesOption = document.createElement('div');
        allCategoriesOption.className = 'filter-option p-2 rounded cursor-pointer hover:bg-orange-50 transition duration-200 text-sm';
        allCategoriesOption.setAttribute('data-category', 'all');
        allCategoriesOption.textContent = 'All Categories';
        
        allCategoriesOption.addEventListener('click', () => {
            currentFilter = 'all';
            const categoryButton = document.getElementById('categoryFilterButton');
            if (categoryButton) {
                categoryButton.querySelector('span').textContent = 'All Categories';
            }
            categoryDropdown.classList.add('hidden');
            filterProducts();
        });
        
        categoryContainer.appendChild(allCategoriesOption);

        // Add categories from API
        categories.forEach(category => {
            const categoryOption = document.createElement('div');
            categoryOption.className = 'filter-option p-2 rounded cursor-pointer hover:bg-orange-50 transition duration-200 text-sm';
            categoryOption.setAttribute('data-category', category._id);
            categoryOption.textContent = category.name;
            
            categoryOption.addEventListener('click', () => {
                currentFilter = category._id;
                const categoryButton = document.getElementById('categoryFilterButton');
                if (categoryButton) {
                    categoryButton.querySelector('span').textContent = category.name;
                }
                categoryDropdown.classList.add('hidden');
                filterProducts();
            });

            categoryContainer.appendChild(categoryOption);
        });

        // Also load into navbar
        loadNavbarCategories(categories);
    }

    function filterProducts() {
        let filteredProducts = allProducts;

        // Apply category filter
        if (currentFilter !== 'all') {
            filteredProducts = filteredProducts.filter(product => 
                product.category?._id === currentFilter
            );
        }

        // Apply search filter
        if (currentSearch) {
            const searchTerm = currentSearch.toLowerCase();
            filteredProducts = filteredProducts.filter(product =>
                product.title.toLowerCase().includes(searchTerm) ||
                product.description.toLowerCase().includes(searchTerm) ||
                (product.category?.name && product.category.name.toLowerCase().includes(searchTerm))
            );
        }

        displayProducts(filteredProducts);
        updateResultsCount(filteredProducts.length);
    }

    function updateResultsCount(count) {
        const resultsCount = document.getElementById('resultsCount');
        if (resultsCount) {
            resultsCount.textContent = count;
        }
    }

    // Search functionality
    function setupSearch() {
        const searchInput = document.getElementById('searchInput');
        if (!searchInput) return;

        let searchTimeout;

        searchInput.addEventListener('input', (e) => {
            currentSearch = e.target.value;
            
            // Debounce search
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                filterProducts();
            }, 300);
        });
    }
    // Clear search functionality
function setupClearSearch() {
    const searchInput = document.getElementById('searchInput');
    const clearSearchButton = document.getElementById('clearSearchButton');

    if (!searchInput || !clearSearchButton) return;

    // Show/hide clear button based on input
    searchInput.addEventListener('input', function() {
        if (this.value.length > 0) {
            clearSearchButton.classList.remove('hidden');
        } else {
            clearSearchButton.classList.add('hidden');
        }
    });

    // Clear search when X is clicked
    clearSearchButton.addEventListener('click', function() {
        searchInput.value = '';
        currentSearch = '';
        clearSearchButton.classList.add('hidden');
        filterProducts();
        searchInput.focus();
    });

    // Also clear when pressing Escape key in search
    searchInput.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            searchInput.value = '';
            currentSearch = '';
            clearSearchButton.classList.add('hidden');
            filterProducts();
        }
    });
}

    // Reset filters function
    function resetFilters() {
        currentFilter = 'all';
        currentSearch = '';
        
        const searchInput = document.getElementById('searchInput');
        const clearSearchButton = document.getElementById('clearSearchButton');
        const categoryButton = document.getElementById('categoryFilterButton');
        
        if (searchInput) searchInput.value = '';
        if (clearSearchButton) clearSearchButton.classList.add('hidden');
        if (categoryButton) categoryButton.querySelector('span').textContent = 'All Categories';
        
        filterProducts();
    }

    // Display products in grid - UPDATED PROFESSIONAL DESIGN
            // Updated displayProducts function with larger titles and tighter spacing
       function displayProducts(products) {
    const productsGrid = document.getElementById('productsGrid');
    const noProducts = document.getElementById('noProducts');
    const legacyCategories = document.getElementById('legacyCategories');

    if (!productsGrid || !noProducts || !legacyCategories) return;

    productsGrid.innerHTML = '';

    if (products.length === 0) {
        productsGrid.classList.add('hidden');
        noProducts.classList.remove('hidden');
        legacyCategories.classList.add('hidden');
        return;
    }

    noProducts.classList.add('hidden');
    legacyCategories.classList.add('hidden');
    productsGrid.classList.remove('hidden');

    products.forEach(product => {
        const imageUrl = product.image || product.imageUrl || '/public/img/placeholder-product.jpg';
        const price = product.price || 'Contact for price';
        
        const productCard = document.createElement('div');
        productCard.className = 'product-card bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden cursor-pointer';
        productCard.innerHTML = `
            <div class="product-image-container relative">
                <img src="${imageUrl}" alt="${product.title}" class="product-image w-full" onerror="this.src='/public/img/placeholder-product.jpg'">
                ${!product.isAvailable ? '<div class="product-card-badge">Out of Stock</div>' : ''}
                ${product.isNew ? '<div class="product-card-badge" style="left: auto; right: 8px; background: linear-gradient(135deg, #10b981, #059669);">New</div>' : ''}
            </div>
            <div class="p-4 flex flex-col flex-1 product-card-content">
                <h3 class="product-title text-gray-800 line-clamp-2 khmer-font compact-title">${product.title}</h3>
                <p class="text-gray-600 text-sm line-clamp-2 compact-text">${product.description || 'No description available'}</p>
                <div class="product-card-actions">
                    <span class="text-base font-extrabold text-orange-600">${price}</span>
                    <button class="bg-orange-500 text-white p-2 rounded-lg hover:bg-orange-600 transition duration-200">
                        <i class="fas fa-eye text-xs"></i>
                    </button>
                </div>
            </div>
        `;
        
        // Add click event to open modal
        productCard.addEventListener('click', () => openProductModal(product));
        
        productsGrid.appendChild(productCard);
    });
}

    // Enhanced product fetching with categories
    async function fetchProductsAndCategories() {
        const productsLoading = document.getElementById('productsLoading');
        const noProducts = document.getElementById('noProducts');
        const legacyCategories = document.getElementById('legacyCategories');

        if (!productsLoading || !noProducts || !legacyCategories) return;

        try {
            productsLoading.classList.remove('hidden');
            noProducts.classList.add('hidden');
            legacyCategories.classList.add('hidden');

            // Fetch products and categories simultaneously
            const [productsResponse, categoriesResponse] = await Promise.all([
                fetch('/api/products/website'),
                fetch('/api/categories/website')
            ]);
            
            if (!productsResponse.ok || !categoriesResponse.ok) {
                throw new Error('Failed to fetch data');
            }
            
            const products = await productsResponse.json();
            const categories = await categoriesResponse.json();

            productsLoading.classList.add('hidden');

            allProducts = products;
            allCategories = categories;

            if (products.length === 0) {
                noProducts.classList.remove('hidden');
                legacyCategories.classList.remove('hidden');
                return;
            }

            // On mobile, we might need to retry loading categories after a short delay
            if (isMobileDevice()) {
                setTimeout(() => {
                    loadCategoriesIntoFilter(categories);
                }, 200);
            } else {
                loadCategoriesIntoFilter(categories);
            }
            
            // Display all products initially
            displayProducts(products);
            updateResultsCount(products.length);

        } catch (error) {
            console.error('Error fetching data:', error);
            productsLoading.classList.add('hidden');
            noProducts.classList.remove('hidden');
            legacyCategories.classList.remove('hidden');
        }
    }

    // Initialize everything when page loads
document.addEventListener('DOMContentLoaded', () => {
    // Small delay to ensure all DOM elements are available
    setTimeout(() => {
        setupCategoryFilter();
        setupSearch();
        setupClearSearch(); // Add this line
        fetchProductsAndCategories();
    }, 100);
});
    </script>
</body>
</html>